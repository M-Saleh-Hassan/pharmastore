(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{mIUB:function(t,e,n){"use strict";n.r(e);var r=n("8Y7J");class i{}var s=n("pMnS"),a=n("CcMi"),l=n("DjsD"),o=n("jXVt"),c=n("tKwJ"),u=n("SVse"),h=n("TXkH"),g=n("vfhJ"),b=n("u50V"),d=n("4Esg"),m=n("yUXM"),f=n("KP+3");class p{constructor(t,e,n,r,i){this.generalDataService=t,this.branchesService=e,this.helperService=n,this.route=r,this.userService=i,this.currentPage=1,this.searchKeyWord="",this.branchsList=[],this.source=new l.a,this.errors={},this.isErrorExist=!1,this.allAreas=[],this.isDoneIntianting=0,this.dayList=[],this.storeId=null}ngOnInit(){this.userType=this.userService.currentUser.role,this.checkUserType(),this.perpareDays(),this.setTable()}checkUserType(){"admin"===this.userType?this.getStoreId():"store"===this.userType&&this.getBranches()}getStoreId(){this.route.params.subscribe(t=>{this.storeId=t.id,this.getBranches()})}getBranches(){this.branchesService.getBranches("area_id",this.searchKeyWord,this.currentPage,this.storeId).subscribe(t=>{this.totalBranchsNo=t.data.total,this.branchsList=t.data.items,this.source.load(this.branchsList),this.isDoneIntianting++})}changePagination(t){this.currentPage=t,this.getBranches()}setTable(){this.tableSettings={add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close" onCancel></i>',confirmCreate:!0},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close" onCancel></i>',confirmSave:!0},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},noDataMessage:"ar"===this.lang?"\u0644\u0645 \u0646\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a":"No data found",actions:{columnTitle:"ar"===this.lang?"\u0645\u0641\u0627\u062a\u064a\u062d":"Actions"},columns:{name:{title:"ar"===this.lang?"\u0627\u0644\u0625\u0633\u0645":"Name",sort:!1,filter:!1},lng:{title:"ar"===this.lang?"\u062e\u0637 \u0627\u0644\u0637\u0648\u0644":"lng",sort:!1,filter:!1},lat:{title:"ar"===this.lang?"\u062e\u0637 \u0627\u0644\u0639\u0631\u0636 ":"lat",sort:!1,filter:!1},mobile:{title:"ar"===this.lang?"\u0627\u0644\u0647\u0627\u062a\u0641":"mobile",sort:!1,filter:!1},working_hours_from:{title:"ar"===this.lang?"\u0633\u0627\u0639\u0629 \u0628\u062f\u0623 \u0627\u0644\u0639\u0645\u0644":"Working Starting hour",sort:!1,filter:!1},working_hours_to:{title:"ar"===this.lang?"\u0633\u0627\u0639\u0629 \u0627\u0644\u063a\u0644\u0642":"Ending hour",sort:!1,filter:!1},working_days_from:{title:"ar"===this.lang?"\u0627\u0648\u0644 \u064a\u0648\u0645 \u0639\u0645\u0644":"Working Starting Day",type:"html",sort:!1,filter:!1,editor:{type:"list",config:{list:this.dayList},valuePrepareFunction:(t,e)=>this.prepareDayValue(t)},valuePrepareFunction:(t,e)=>this.prepareDayValue(t)},working_days_to:{title:"ar"===this.lang?"\u0627\u062e\u0631 \u064a\u0648\u0645":"Ending Day",type:"html",sort:!1,filter:!1,editor:{type:"list",config:{list:this.dayList}},valuePrepareFunction:(t,e)=>this.prepareDayValue(t)},area_id:{title:"ar"===this.lang?"\u0627\u0644\u0645\u0646\u0637\u0642\u0629":"Area",sort:!1,filter:!1,type:"html",editor:{type:"list",config:{list:this.getAllAreas()}},valuePrepareFunction:t=>this.prepareAreaValue(t)}}},"store"===this.userType&&(this.tableSettings.actions=!1)}onCancel(){this.isErrorExist=!1,this.errors={}}createBranch(t){this.branchesService.createBranch(t.newData,this.storeId).subscribe(e=>{1===e.status&&t.confirm.resolve(e.data)})}updateBranch(t){this.branchesService.updateBranch(t.newData.id,t.newData,this.storeId).subscribe(e=>{1===e.status&&t.confirm.resolve(e.data)})}onDeleteConfirm(t){window.confirm(this.lang?"\u0647\u0644 \u0627\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0627\u0644\u062d\u0630\u0641\u061f":"Are you sure you want to delete?")?this.deteteItem(t):t.confirm.reject()}deteteItem(t){this.branchesService.deleteBranch(t.data.id,this.storeId).subscribe(e=>{1===e.status&&t.confirm.resolve()})}checkData(t,e){const n=e.newData;this.errors={},this.isErrorExist=!1,["name","area_id","mobile","lng","lat","working_hours_from","working_hours_to","working_days_from","working_days_to"].forEach(t=>{n[t]||(this.errors[t]="required-data",this.isErrorExist=!0),"mobile"===t&&n.mobile&&this.checkMobile("mobile1",n.mobile),"working_hours_to"===t&&n.working_hours_to&&this.checkTime("working_hours_to",n.working_hours_to),"working_hours_from"===t&&n.working_hours_from&&this.checkTime("working_hours_from",n.working_hours_from),"lat"===t&&n.lat&&this.checkLat(n.lat),"lng"===t&&n.lng&&this.checkLng(n.lng)}),this.isErrorExist?this.showErrors():"create"===t?this.createBranch(e):"update"===t&&this.updateBranch(e)}checkTime(t,e){(isNaN(e)||e<1||e>12)&&(this.errors[t]="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.isErrorExist=!0)}checkMobile(t,e){/[0-9][0-9][0-9][0-9]+/.test(e)||(this.errors[t]="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.errors[t]+=" (0123465789)",this.isErrorExist=!0)}checkLng(t){/^(\+|-)?(?:90(?:(?:\.0{1,6})?)|(?:[0-9]|[1-8][0-9])(?:(?:\.[0-9]{1,6})?))$/.test(t)||(this.errors.lng="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.errors.lng+=" (21.422510)",this.isErrorExist=!0)}checkLat(t){/^(\+|-)?(?:180(?:(?:\.0{1,6})?)|(?:[0-9]|[1-9][0-9]|1[0-7][0-9])(?:(?:\.[0-9]{1,6})?))$/.test(t)||(this.errors.lat="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.errors.lat+=" (39.826168)",this.isErrorExist=!0)}showErrors(){for(const t in this.errors)this.errors.hasOwnProperty(t)&&this.helperService.showTranslatedToast("warning",this.errors[t],t)}perpareDays(){this.lang=localStorage.getItem("lang"),this.dayList=[{value:"sat",title:"ar"===this.lang?"\u0627\u0644\u0633\u0628\u062a":"SAT"},{value:"sun",title:"ar"===this.lang?"\u0627\u0644\u0623\u062d\u062f":"SUN"},{value:"mon",title:"ar"===this.lang?"\u0627\u0644\u0623\u062b\u0646\u064a\u0646":"MON"},{value:"tue",title:"ar"===this.lang?"\u0627\u0644\u062b\u0644\u0627\u062b\u0627\u0621":"TUE"},{value:"wed",title:"ar"===this.lang?"\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621":"WED"},{value:"thu",title:"ar"===this.lang?"\u0627\u0644\u062e\u0645\u064a\u0633":"THU"},{value:"fri",title:"ar"===this.lang?"\u0627\u0644\u062c\u0645\u0639\u0629":"FRI"}]}prepareDayValue(t){const e=this.dayList.find(e=>e.value===t);return e?e.title:null}getAllAreas(){this.generalDataService.getAreas(0,0).subscribe(t=>{let e=0;t.data.items.forEach(n=>{this.allAreas.push({value:n.id,title:n.name_en}),e++,e===t.data.items.length&&(this.tableSettings.columns.area_id.editor.config.list=this.allAreas,this.isDoneIntianting++)})})}prepareAreaValue(t){const e=this.allAreas.find(e=>e.value.toString()===t.toString());return e?e.title:null}}var y=n("iInd"),v=r.Hb({encapsulation:0,styles:[["[_nghost-%COMP%]     ng2-st-tbody-edit-delete{display:flex!important;height:0!important}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom{display:inline-block;width:50px;text-align:center;font-size:1.1em;color:#36f}  ng2-smart-table .ng2-smart-actions{text-align:center!important}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom:hover{color:#000}.search[_ngcontent-%COMP%]:disabled{background-color:#fff;border:2px solid rgba(0,0,0,.1);color:#36f;box-shadow:0 7px 11px 0 #00000047}"]],data:{}});function k(t){return r.fc(0,[(t()(),r.Jb(0,0,null,null,1,"ng2-smart-table",[],null,[[null,"deleteConfirm"],[null,"editConfirm"],[null,"createConfirm"]],(function(t,e,n){var r=!0,i=t.component;return"deleteConfirm"===e&&(r=!1!==i.onDeleteConfirm(n)&&r),"editConfirm"===e&&(r=!1!==i.checkData("update",n)&&r),"createConfirm"===e&&(r=!1!==i.checkData("create",n)&&r),r}),a.b,a.a)),r.Ib(1,573440,null,0,l.s,[],{source:[0,"source"],settings:[1,"settings"]},{deleteConfirm:"deleteConfirm",editConfirm:"editConfirm",createConfirm:"createConfirm"})],(function(t,e){var n=e.component;t(e,1,0,n.source,n.tableSettings)}),null)}function T(t){return r.fc(0,[r.bc(671088640,1,{cancelBtn:0}),(t()(),r.Jb(1,16777216,null,null,13,"nb-card",[["nbSpinnerSize","giant"],["nbSpinnerStatus","primary"]],[[2,"size-tiny",null],[2,"size-small",null],[2,"size-medium",null],[2,"size-large",null],[2,"size-giant",null],[2,"status-primary",null],[2,"status-info",null],[2,"status-success",null],[2,"status-warning",null],[2,"status-danger",null],[2,"accent",null],[2,"accent-primary",null],[2,"accent-info",null],[2,"accent-success",null],[2,"accent-warning",null],[2,"accent-danger",null],[2,"nb-spinner-container",null]],null,null,o.J,o.s)),r.Ib(2,49152,null,0,c.jb,[],null,null),r.Ib(3,81920,null,0,c.qd,[r.fb,r.m,r.Q,r.q],{spinnerStatus:[0,"spinnerStatus"],spinnerSize:[1,"spinnerSize"],nbSpinner:[2,"nbSpinner"]},null),(t()(),r.Jb(4,0,null,1,6,"nb-card-body",[],null,null,null,o.I,o.r)),r.Ib(5,49152,null,0,c.ib,[],null,null),(t()(),r.Jb(6,0,null,0,4,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),r.Jb(7,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(t()(),r.Jb(8,0,null,null,2,"div",[["class","col-12 overflow-auto"]],null,null,null,null,null)),(t()(),r.yb(16777216,null,null,1,null,k)),r.Ib(10,16384,null,0,u.l,[r.fb,r.Z],{ngIf:[0,"ngIf"]},null),(t()(),r.Jb(11,0,null,3,3,"nb-card-footer",[],null,null,null,o.K,o.t)),r.Ib(12,49152,null,0,c.kb,[],null,null),(t()(),r.Jb(13,0,null,0,1,"ngx-pagination",[["class","mt-5"]],null,[[null,"pageChange"]],(function(t,e,n){var r=!0;return"pageChange"===e&&(r=!1!==t.component.changePagination(n)&&r),r}),h.b,h.a)),r.Ib(14,638976,null,0,g.a,[],{arrayLength:[0,"arrayLength"],currentPage:[1,"currentPage"]},{pageChange:"pageChange"})],(function(t,e){var n=e.component;t(e,3,0,"primary","giant",2!=n.isDoneIntianting),t(e,10,0,2==n.isDoneIntianting),t(e,14,0,n.totalBranchsNo,n.currentPage)}),(function(t,e){t(e,1,1,[r.Vb(e,2).tiny,r.Vb(e,2).small,r.Vb(e,2).medium,r.Vb(e,2).large,r.Vb(e,2).giant,r.Vb(e,2).primary,r.Vb(e,2).info,r.Vb(e,2).success,r.Vb(e,2).warning,r.Vb(e,2).danger,r.Vb(e,2).hasAccent,r.Vb(e,2).primaryAccent,r.Vb(e,2).infoAccent,r.Vb(e,2).successAccent,r.Vb(e,2).warningAccent,r.Vb(e,2).dangerAccent,r.Vb(e,3).isSpinnerExist])}))}function w(t){return r.fc(0,[(t()(),r.Jb(0,0,null,null,1,"ngx-branches",[],null,[[null,"click"]],(function(t,e,n){var i=!0;return"click"===e&&(i=!1!==r.Vb(t,1).onCancel(n)&&i),i}),T,v)),r.Ib(1,114688,null,0,p,[f.a,m.a,d.a,y.a,b.a],null,null)],(function(t,e){t(e,1,0)}),null)}var S=r.Fb("ngx-branches",p,w,{},{},[]),_=n("s7LF"),D=n("TYxm"),C=n("IheW");class I{}var E=n("a98O"),V=n("TSSN");n.d(e,"BranchesModuleNgFactory",(function(){return x}));var x=r.Gb(i,[],(function(t){return r.Sb([r.Tb(512,r.m,r.rb,[[8,[s.a,S,o.k]],[3,r.m],r.H]),r.Tb(4608,u.n,u.m,[r.D,[2,u.G]]),r.Tb(4608,_.y,_.y,[]),r.Tb(4608,_.f,_.f,[]),r.Tb(4608,D.i,D.i,[]),r.Tb(4608,D.k,D.k,[C.c]),r.Tb(4608,D.c,D.c,[D.i,D.k]),r.Tb(1073742336,u.b,u.b,[]),r.Tb(1073742336,y.p,y.p,[[2,y.u],[2,y.l]]),r.Tb(1073742336,I,I,[]),r.Tb(1073742336,_.x,_.x,[]),r.Tb(1073742336,_.i,_.i,[]),r.Tb(1073742336,_.t,_.t,[]),r.Tb(1073742336,D.j,D.j,[]),r.Tb(1073742336,l.c,l.c,[]),r.Tb(1073742336,l.D,l.D,[]),r.Tb(1073742336,l.L,l.L,[]),r.Tb(1073742336,l.N,l.N,[]),r.Tb(1073742336,l.h,l.h,[]),r.Tb(1073742336,l.b,l.b,[]),r.Tb(1073742336,E.a,E.a,[]),r.Tb(1073742336,V.h,V.h,[]),r.Tb(1073742336,c.ke,c.ke,[]),r.Tb(1073742336,c.dc,c.dc,[]),r.Tb(1073742336,c.bc,c.bc,[c.ac]),r.Tb(1073742336,c.nb,c.nb,[]),r.Tb(1073742336,c.rd,c.rd,[]),r.Tb(1073742336,i,i,[]),r.Tb(1024,y.j,(function(){return[[{path:"",component:p}]]}),[])])}))}}]);