(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{mIUB:function(t,n,e){"use strict";e.r(n);var r=e("8Y7J");class i{}var a=e("pMnS"),l=e("CcMi"),s=e("DjsD"),o=e("jXVt"),c=e("tKwJ"),u=e("SVse"),h=e("TXkH"),b=e("vfhJ"),g=e("4Esg"),d=e("yUXM"),m=e("KP+3");class f{constructor(t,n,e){this.generalDataService=t,this.branchesService=n,this.helperService=e,this.currentPage=1,this.searchKeyWord="",this.branchsList=[],this.source=new s.a,this.errors={},this.isErrorExist=!1,this.allAreas=[],this.isDoneIntianting=0,this.dayList=[]}ngOnInit(){this.perpareDays(),this.getBranches(),this.setTable()}getBranches(){this.branchesService.getBranches("area_id",this.searchKeyWord,this.currentPage).subscribe(t=>{this.totalBranchsNo=t.data.total,this.branchsList=t.data.items,this.source.load(this.branchsList),this.isDoneIntianting++})}changePagination(t){this.currentPage=t,this.getBranches()}setTable(){this.tableSettings={add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close" onCancel></i>',confirmCreate:!0},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close" onCancel></i>',confirmSave:!0},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},noDataMessage:"ar"===this.lang?"\u0644\u0645 \u0646\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a":"No data found",actions:{columnTitle:"ar"===this.lang?"\u0645\u0641\u0627\u062a\u064a\u062d":"Actions"},columns:{name:{title:"ar"===this.lang?"\u0627\u0644\u0625\u0633\u0645":"Name",sort:!1,filter:!1},lng:{title:"ar"===this.lang?"\u062e\u0637 \u0627\u0644\u0637\u0648\u0644":"lng",sort:!1,filter:!1},lat:{title:"ar"===this.lang?"\u062e\u0637 \u0627\u0644\u0639\u0631\u0636 ":"lat",sort:!1,filter:!1},mobile:{title:"ar"===this.lang?"\u0627\u0644\u0647\u0627\u062a\u0641":"mobile",sort:!1,filter:!1},working_hours_from:{title:"ar"===this.lang?"\u0633\u0627\u0639\u0629 \u0628\u062f\u0623 \u0627\u0644\u0639\u0645\u0644":"Working Starting hour",sort:!1,filter:!1},working_hours_to:{title:"ar"===this.lang?"\u0633\u0627\u0639\u0629 \u0627\u0644\u063a\u0644\u0642":"Ending hour",sort:!1,filter:!1},working_days_from:{title:"ar"===this.lang?"\u0627\u0648\u0644 \u064a\u0648\u0645 \u0639\u0645\u0644":"Working Starting Day",type:"html",sort:!1,filter:!1,editor:{type:"list",config:{list:this.dayList},valuePrepareFunction:(t,n)=>this.prepareDayValue(t)},valuePrepareFunction:(t,n)=>this.prepareDayValue(t)},working_days_to:{title:"ar"===this.lang?"\u0627\u062e\u0631 \u064a\u0648\u0645":"Ending Day",type:"html",sort:!1,filter:!1,editor:{type:"list",config:{list:this.dayList}},valuePrepareFunction:(t,n)=>this.prepareDayValue(t)},area_id:{title:"ar"===this.lang?"\u0627\u0644\u0645\u0646\u0637\u0642\u0629":"Area",sort:!1,filter:!1,type:"html",editor:{type:"list",config:{list:this.getAllAreas()}},valuePrepareFunction:t=>this.prepareAreaValue(t)}}}}onCancel(){this.isErrorExist=!1,this.errors={}}createBranch(t){this.branchesService.createBranch(t.newData).subscribe(n=>{1===n.status&&t.confirm.resolve(n.data)})}updateBranch(t){this.branchesService.updateBranch(t.newData.id,t.newData).subscribe(n=>{1===n.status&&t.confirm.resolve(n.data)})}onDeleteConfirm(t){window.confirm(this.lang?"\u0647\u0644 \u0627\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0627\u0644\u062d\u0630\u0641\u061f":"Are you sure you want to delete?")?this.deteteItem(t):t.confirm.reject()}deteteItem(t){this.branchesService.deleteBranch(t.data.id).subscribe(n=>{1===n.status&&t.confirm.resolve()})}checkData(t,n){const e=n.newData;this.errors={},this.isErrorExist=!1,["name","area_id","mobile","lng","lat","working_hours_from","working_hours_to","working_days_from","working_days_to"].forEach(t=>{e[t]||(this.errors[t]="required-data",this.isErrorExist=!0),"mobile"===t&&e.mobile&&this.checkMobile("mobile1",e.mobile),"working_hours_to"===t&&e.working_hours_to&&this.checkTime("working_hours_to",e.working_hours_to),"working_hours_from"===t&&e.working_hours_from&&this.checkTime("working_hours_from",e.working_hours_from),"lat"===t&&e.lat&&this.checkLat(e.lat),"lng"===t&&e.lng&&this.checkLng(e.lng)}),this.isErrorExist?this.showErrors():"create"===t?this.createBranch(n):"update"===t&&this.updateBranch(n)}checkTime(t,n){(isNaN(n)||n<1||n>12)&&(this.errors[t]="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.isErrorExist=!0)}checkMobile(t,n){/[0-9][0-9][0-9][0-9]+/.test(n)||(this.errors[t]="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.errors[t]+=" (0123465789)",this.isErrorExist=!0)}checkLng(t){/^(\+|-)?(?:90(?:(?:\.0{1,6})?)|(?:[0-9]|[1-8][0-9])(?:(?:\.[0-9]{1,6})?))$/.test(t)||(this.errors.lng="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.errors.lng+=" (21.422510)",this.isErrorExist=!0)}checkLat(t){/^(\+|-)?(?:180(?:(?:\.0{1,6})?)|(?:[0-9]|[1-9][0-9]|1[0-7][0-9])(?:(?:\.[0-9]{1,6})?))$/.test(t)||(this.errors.lat="ar"===this.lang?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u062e\u0627\u0637\u0626\u0629 ":"Data entered is invalid",this.errors.lat+=" (39.826168)",this.isErrorExist=!0)}showErrors(){for(const t in this.errors)this.errors.hasOwnProperty(t)&&this.helperService.showTranslatedToast("warning",this.errors[t],t)}perpareDays(){this.lang=localStorage.getItem("lang"),this.dayList=[{value:"sat",title:"ar"===this.lang?"\u0627\u0644\u0633\u0628\u062a":"SAT"},{value:"sun",title:"ar"===this.lang?"\u0627\u0644\u0623\u062d\u062f":"SUN"},{value:"mon",title:"ar"===this.lang?"\u0627\u0644\u0623\u062b\u0646\u064a\u0646":"MON"},{value:"tue",title:"ar"===this.lang?"\u0627\u0644\u062b\u0644\u0627\u062b\u0627\u0621":"TUE"},{value:"wed",title:"ar"===this.lang?"\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621":"WED"},{value:"thu",title:"ar"===this.lang?"\u0627\u0644\u062e\u0645\u064a\u0633":"THU"},{value:"fri",title:"ar"===this.lang?"\u0627\u0644\u062c\u0645\u0639\u0629":"FRI"}]}prepareDayValue(t){const n=this.dayList.find(n=>n.value===t);return n?n.title:null}getAllAreas(){this.generalDataService.getAreas(0,0).subscribe(t=>{let n=0;t.data.items.forEach(e=>{this.allAreas.push({value:e.id,title:e.name_en}),n++,n===t.data.items.length&&(this.tableSettings.columns.area_id.editor.config.list=this.allAreas,this.isDoneIntianting++)})})}prepareAreaValue(t){const n=this.allAreas.find(n=>n.value.toString()===t.toString());return n?n.title:null}}var p=r.Hb({encapsulation:0,styles:[["[_nghost-%COMP%]     ng2-st-tbody-edit-delete{display:flex!important;height:0!important}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom{display:inline-block;width:50px;text-align:center;font-size:1.1em;color:#36f}  ng2-smart-table .ng2-smart-actions{text-align:center!important}[_nghost-%COMP%]     ng2-st-tbody-custom a.ng2-smart-action.ng2-smart-action-custom-custom:hover{color:#000}.search[_ngcontent-%COMP%]:disabled{background-color:#fff;border:2px solid rgba(0,0,0,.1);color:#36f;box-shadow:0 7px 11px 0 #00000047}"]],data:{}});function y(t){return r.fc(0,[(t()(),r.Jb(0,0,null,null,1,"ng2-smart-table",[],null,[[null,"deleteConfirm"],[null,"editConfirm"],[null,"createConfirm"]],(function(t,n,e){var r=!0,i=t.component;return"deleteConfirm"===n&&(r=!1!==i.onDeleteConfirm(e)&&r),"editConfirm"===n&&(r=!1!==i.checkData("update",e)&&r),"createConfirm"===n&&(r=!1!==i.checkData("create",e)&&r),r}),l.b,l.a)),r.Ib(1,573440,null,0,s.s,[],{source:[0,"source"],settings:[1,"settings"]},{deleteConfirm:"deleteConfirm",editConfirm:"editConfirm",createConfirm:"createConfirm"})],(function(t,n){var e=n.component;t(n,1,0,e.source,e.tableSettings)}),null)}function v(t){return r.fc(0,[r.bc(671088640,1,{cancelBtn:0}),(t()(),r.Jb(1,16777216,null,null,13,"nb-card",[["nbSpinnerSize","giant"],["nbSpinnerStatus","primary"]],[[2,"size-tiny",null],[2,"size-small",null],[2,"size-medium",null],[2,"size-large",null],[2,"size-giant",null],[2,"status-primary",null],[2,"status-info",null],[2,"status-success",null],[2,"status-warning",null],[2,"status-danger",null],[2,"accent",null],[2,"accent-primary",null],[2,"accent-info",null],[2,"accent-success",null],[2,"accent-warning",null],[2,"accent-danger",null],[2,"nb-spinner-container",null]],null,null,o.J,o.s)),r.Ib(2,49152,null,0,c.jb,[],null,null),r.Ib(3,81920,null,0,c.qd,[r.fb,r.m,r.Q,r.q],{spinnerStatus:[0,"spinnerStatus"],spinnerSize:[1,"spinnerSize"],nbSpinner:[2,"nbSpinner"]},null),(t()(),r.Jb(4,0,null,1,6,"nb-card-body",[],null,null,null,o.I,o.r)),r.Ib(5,49152,null,0,c.ib,[],null,null),(t()(),r.Jb(6,0,null,0,4,"div",[["class","container-fluid"]],null,null,null,null,null)),(t()(),r.Jb(7,0,null,null,3,"div",[["class","row"]],null,null,null,null,null)),(t()(),r.Jb(8,0,null,null,2,"div",[["class","col-12 overflow-auto"]],null,null,null,null,null)),(t()(),r.yb(16777216,null,null,1,null,y)),r.Ib(10,16384,null,0,u.l,[r.fb,r.Z],{ngIf:[0,"ngIf"]},null),(t()(),r.Jb(11,0,null,3,3,"nb-card-footer",[],null,null,null,o.K,o.t)),r.Ib(12,49152,null,0,c.kb,[],null,null),(t()(),r.Jb(13,0,null,0,1,"ngx-pagination",[["class","mt-5"]],null,[[null,"pageChange"]],(function(t,n,e){var r=!0;return"pageChange"===n&&(r=!1!==t.component.changePagination(e)&&r),r}),h.b,h.a)),r.Ib(14,638976,null,0,b.a,[],{arrayLength:[0,"arrayLength"],currentPage:[1,"currentPage"]},{pageChange:"pageChange"})],(function(t,n){var e=n.component;t(n,3,0,"primary","giant",2!=e.isDoneIntianting),t(n,10,0,2==e.isDoneIntianting),t(n,14,0,e.totalBranchsNo,e.currentPage)}),(function(t,n){t(n,1,1,[r.Vb(n,2).tiny,r.Vb(n,2).small,r.Vb(n,2).medium,r.Vb(n,2).large,r.Vb(n,2).giant,r.Vb(n,2).primary,r.Vb(n,2).info,r.Vb(n,2).success,r.Vb(n,2).warning,r.Vb(n,2).danger,r.Vb(n,2).hasAccent,r.Vb(n,2).primaryAccent,r.Vb(n,2).infoAccent,r.Vb(n,2).successAccent,r.Vb(n,2).warningAccent,r.Vb(n,2).dangerAccent,r.Vb(n,3).isSpinnerExist])}))}function k(t){return r.fc(0,[(t()(),r.Jb(0,0,null,null,1,"ngx-branches",[],null,[[null,"click"]],(function(t,n,e){var i=!0;return"click"===n&&(i=!1!==r.Vb(t,1).onCancel(e)&&i),i}),v,p)),r.Ib(1,114688,null,0,f,[m.a,d.a,g.a],null,null)],(function(t,n){t(n,1,0)}),null)}var w=r.Fb("ngx-branches",f,k,{},{},[]),T=e("s7LF"),_=e("TYxm"),D=e("IheW"),S=e("iInd");class C{}var E=e("a98O"),V=e("TSSN");e.d(n,"BranchesModuleNgFactory",(function(){return x}));var x=r.Gb(i,[],(function(t){return r.Sb([r.Tb(512,r.m,r.rb,[[8,[a.a,w,o.k]],[3,r.m],r.H]),r.Tb(4608,u.n,u.m,[r.D,[2,u.G]]),r.Tb(4608,T.y,T.y,[]),r.Tb(4608,T.f,T.f,[]),r.Tb(4608,_.i,_.i,[]),r.Tb(4608,_.k,_.k,[D.c]),r.Tb(4608,_.c,_.c,[_.i,_.k]),r.Tb(1073742336,u.b,u.b,[]),r.Tb(1073742336,S.p,S.p,[[2,S.u],[2,S.l]]),r.Tb(1073742336,C,C,[]),r.Tb(1073742336,T.x,T.x,[]),r.Tb(1073742336,T.i,T.i,[]),r.Tb(1073742336,T.t,T.t,[]),r.Tb(1073742336,_.j,_.j,[]),r.Tb(1073742336,s.c,s.c,[]),r.Tb(1073742336,s.D,s.D,[]),r.Tb(1073742336,s.L,s.L,[]),r.Tb(1073742336,s.N,s.N,[]),r.Tb(1073742336,s.h,s.h,[]),r.Tb(1073742336,s.b,s.b,[]),r.Tb(1073742336,E.a,E.a,[]),r.Tb(1073742336,V.h,V.h,[]),r.Tb(1073742336,c.ke,c.ke,[]),r.Tb(1073742336,c.dc,c.dc,[]),r.Tb(1073742336,c.bc,c.bc,[c.ac]),r.Tb(1073742336,c.nb,c.nb,[]),r.Tb(1073742336,c.rd,c.rd,[]),r.Tb(1073742336,i,i,[]),r.Tb(1024,S.j,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);